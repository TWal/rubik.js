//License: https://github.com/TWal/rubik.js/blob/master/LICENSE and https://github.com/toji/gl-matrix/blob/master/LICENSE.md (glmatrix)

(function(l){var u;"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(u={},define(function(){return u})):u="undefined"!=typeof window?window:l:u=exports;(function(l){if(!u)var u=1E-6;if(!s)var s="undefined"!=typeof Float32Array?Float32Array:Array;if(!D)var D=Math.random;var x={setMatrixArrayType:function(a){s=a}};"undefined"!=typeof l&&(l.glMatrix=x);var w={create:function(){var a=new s(2);return a[0]=0,a[1]=0,a},clone:function(a){var b=new s(2);return b[0]=
a[0],b[1]=a[1],b},fromValues:function(a,b){var c=new s(2);return c[0]=a,c[1]=b,c},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a},set:function(a,b,c){return a[0]=b,a[1]=c,a},add:function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a},subtract:function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a}};w.sub=w.subtract;w.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a};w.mul=w.multiply;w.divide=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a};w.div=w.divide;w.min=function(a,b,
c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a};w.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a};w.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a};w.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a};w.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)};w.dist=w.distance;w.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d};w.sqrDist=w.squaredDistance;w.length=function(a){var b=
a[0];a=a[1];return Math.sqrt(b*b+a*a)};w.len=w.length;w.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};w.sqrLen=w.squaredLength;w.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a};w.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;return 0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c),a};w.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};w.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];return a[0]=a[1]=0,a[2]=b,a};w.lerp=function(a,b,c,d){var e=b[0];b=b[1];return a[0]=e+d*(c[0]-e),a[1]=
b+d*(c[1]-b),a};w.random=function(a,b){b=b||1;var c=2*D()*Math.PI;return a[0]=Math.cos(c)*b,a[1]=Math.sin(c)*b,a};w.transformMat2=function(a,b,c){var d=b[0];b=b[1];return a[0]=c[0]*d+c[2]*b,a[1]=c[1]*d+c[3]*b,a};w.transformMat2d=function(a,b,c){var d=b[0];b=b[1];return a[0]=c[0]*d+c[2]*b+c[4],a[1]=c[1]*d+c[3]*b+c[5],a};w.transformMat3=function(a,b,c){var d=b[0];b=b[1];return a[0]=c[0]*d+c[3]*b+c[6],a[1]=c[1]*d+c[4]*b+c[7],a};w.transformMat4=function(a,b,c){var d=b[0];b=b[1];return a[0]=c[0]*d+c[4]*
b+c[12],a[1]=c[1]*d+c[5]*b+c[13],a};w.forEach=function(){var a=w.create();return function(b,c,d,e,f,g){var h;c||(c=2);d||(d=0);for(e?h=Math.min(e*c+d,b.length):h=b.length;d<h;d+=c)a[0]=b[d],a[1]=b[d+1],f(a,a,g),b[d]=a[0],b[d+1]=a[1];return b}}();w.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!=typeof l&&(l.vec2=w);var q={create:function(){var a=new s(3);return a[0]=0,a[1]=0,a[2]=0,a},clone:function(a){var b=new s(3);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b},fromValues:function(a,b,c){var d=
new s(3);return d[0]=a,d[1]=b,d[2]=c,d},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a},set:function(a,b,c,d){return a[0]=b,a[1]=c,a[2]=d,a},add:function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a},subtract:function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a}};q.sub=q.subtract;q.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a};q.mul=q.multiply;q.divide=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],
a};q.div=q.divide;q.min=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a};q.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a};q.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a};q.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a};q.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)};q.dist=q.distance;
q.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e};q.sqrDist=q.squaredDistance;q.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};q.len=q.length;q.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};q.sqrLen=q.squaredLength;q.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a};q.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],c=c*c+d*d+e*e;return 0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*
c),a};q.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};q.cross=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[0],g=c[1];c=c[2];return a[0]=e*c-b*g,a[1]=b*f-d*c,a[2]=d*g-e*f,a};q.lerp=function(a,b,c,d){var e=b[0],f=b[1];b=b[2];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=b+d*(c[2]-b),a};q.random=function(a,b){b=b||1;var c=2*D()*Math.PI,d=2*D()-1,e=Math.sqrt(1-d*d)*b;return a[0]=Math.cos(c)*e,a[1]=Math.sin(c)*e,a[2]=d*b,a};q.transformMat4=function(a,b,c){var d=b[0],e=b[1];b=b[2];return a[0]=
c[0]*d+c[4]*e+c[8]*b+c[12],a[1]=c[1]*d+c[5]*e+c[9]*b+c[13],a[2]=c[2]*d+c[6]*e+c[10]*b+c[14],a};q.transformMat3=function(a,b,c){var d=b[0],e=b[1];b=b[2];return a[0]=d*c[0]+e*c[3]+b*c[6],a[1]=d*c[1]+e*c[4]+b*c[7],a[2]=d*c[2]+e*c[5]+b*c[8],a};q.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=c[0];var g=c[1],h=c[2];c=c[3];var k=c*d+g*f-h*e,m=c*e+h*d-b*f,p=c*f+b*e-g*d,d=-b*d-g*e-h*f;return a[0]=k*c+d*-b+m*-h-p*-g,a[1]=m*c+d*-g+p*-b-k*-h,a[2]=p*c+d*-h+k*-g-m*-b,a};q.forEach=function(){var a=q.create();
return function(b,c,d,e,f,g){var h;c||(c=3);d||(d=0);for(e?h=Math.min(e*c+d,b.length):h=b.length;d<h;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],f(a,a,g),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();q.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!=typeof l&&(l.vec3=q);var n={create:function(){var a=new s(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},clone:function(a){var b=new s(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},fromValues:function(a,b,c,d){var e=new s(4);return e[0]=
a,e[1]=b,e[2]=c,e[3]=d,e},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},set:function(a,b,c,d,e){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a},add:function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a[3]=b[3]+c[3],a},subtract:function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a[3]=b[3]-c[3],a}};n.sub=n.subtract;n.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a[3]=b[3]*c[3],a};n.mul=n.multiply;n.divide=function(a,b,c){return a[0]=
b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a[3]=b[3]/c[3],a};n.div=n.divide;n.min=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a[3]=Math.min(b[3],c[3]),a};n.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a[3]=Math.max(b[3],c[3]),a};n.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a};n.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+
c[2]*d,a[3]=b[3]+c[3]*d,a};n.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+f*f)};n.dist=n.distance;n.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f};n.sqrDist=n.squaredDistance;n.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};n.len=n.length;n.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};n.sqrLen=n.squaredLength;
n.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=-b[3],a};n.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],c=c*c+d*d+e*e+f*f;return 0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c),a};n.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};n.lerp=function(a,b,c,d){var e=b[0],f=b[1],g=b[2];b=b[3];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a[3]=b+d*(c[3]-b),a};n.random=function(a,b){return b=b||1,a[0]=D(),a[1]=D(),a[2]=
D(),a[3]=D(),n.normalize(a,a),n.scale(a,a,b),a};n.transformMat4=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*b,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*b,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*b,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*b,a};n.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=c[0];var g=c[1],h=c[2];c=c[3];var k=c*d+g*f-h*e,m=c*e+h*d-b*f,p=c*f+b*e-g*d,d=-b*d-g*e-h*f;return a[0]=k*c+d*-b+m*-h-p*-g,a[1]=m*c+d*-g+p*-b-k*-h,a[2]=p*c+d*-h+k*-g-m*-b,a};n.forEach=
function(){var a=n.create();return function(b,c,d,e,f,g){var h;c||(c=4);d||(d=0);for(e?h=Math.min(e*c+d,b.length):h=b.length;d<h;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],a[3]=b[d+3],f(a,a,g),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2],b[d+3]=a[3];return b}}();n.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!=typeof l&&(l.vec4=n);x={create:function(){var a=new s(4);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},clone:function(a){var b=new s(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=
a[3],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},transpose:function(a,b){if(a===b){var c=b[1];a[1]=b[2];a[2]=c}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*f-e*d;return g?(g=1/g,a[0]=f*g,a[1]=-d*g,a[2]=-e*g,a[3]=c*g,a):null},adjoint:function(a,b){var c=b[0];return a[0]=b[3],a[1]=-b[1],a[2]=-b[2],a[3]=c,a},determinant:function(a){return a[0]*a[3]-
a[2]*a[1]},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],k=c[2];c=c[3];return a[0]=d*g+e*k,a[1]=d*h+e*c,a[2]=f*g+b*k,a[3]=f*h+b*c,a}};x.mul=x.multiply;x.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);return a[0]=d*c+e*g,a[1]=d*-g+e*c,a[2]=f*c+b*g,a[3]=f*-g+b*c,a};x.scale=function(a,b,c){var d=b[1],e=b[2],f=b[3],g=c[0];c=c[1];return a[0]=b[0]*g,a[1]=d*c,a[2]=e*g,a[3]=f*c,a};x.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+
", "+a[3]+")"};"undefined"!=typeof l&&(l.mat2=x);x={create:function(){var a=new s(6);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},clone:function(a){var b=new s(6);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=c*f-d*e;return k?(k=1/k,a[0]=f*
k,a[1]=-d*k,a[2]=-e*k,a[3]=c*k,a[4]=(e*h-f*g)*k,a[5]=(d*g-c*h)*k,a):null},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var k=c[0],m=c[1],p=c[2],r=c[3],y=c[4];c=c[5];return a[0]=d*k+e*p,a[1]=d*m+e*r,a[2]=f*k+g*p,a[3]=f*m+g*r,a[4]=k*h+p*b+y,a[5]=m*h+r*b+c,a}};x.mul=x.multiply;x.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var k=Math.sin(c);c=Math.cos(c);return a[0]=d*c+e*k,a[1]=-d*k+e*c,a[2]=f*c+g*
k,a[3]=-f*k+c*g,a[4]=c*h+k*b,a[5]=c*b-k*h,a};x.scale=function(a,b,c){var d=c[0];c=c[1];return a[0]=b[0]*d,a[1]=b[1]*c,a[2]=b[2]*d,a[3]=b[3]*c,a[4]=b[4]*d,a[5]=b[5]*c,a};x.translate=function(a,b,c){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4]+c[0],a[5]=b[5]+c[1],a};x.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};"undefined"!=typeof l&&(l.mat2d=x);var F={create:function(){var a=new s(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,
a[7]=0,a[8]=1,a},fromMat4:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[4],a[4]=b[5],a[5]=b[6],a[6]=b[8],a[7]=b[9],a[8]=b[10],a},clone:function(a){var b=new s(9);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},transpose:function(a,
b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],m=b[7],p=b[8],r=p*g-h*m,y=-p*f+h*k,v=m*f-g*k,E=c*r+d*y+e*v;return E?(E=1/E,a[0]=r*E,a[1]=(-p*d+e*m)*E,a[2]=(h*d-e*g)*E,a[3]=y*E,a[4]=(p*c-e*k)*E,a[5]=(-h*c+e*f)*E,a[6]=v*E,a[7]=(-m*c+d*k)*E,a[8]=(g*c-d*f)*E,a):null},adjoint:function(a,
b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],m=b[7],p=b[8];return a[0]=g*p-h*m,a[1]=e*m-d*p,a[2]=d*h-e*g,a[3]=h*k-f*p,a[4]=c*p-e*k,a[5]=e*f-c*h,a[6]=f*m-g*k,a[7]=d*k-c*m,a[8]=c*g-d*f,a},determinant:function(a){var b=a[3],c=a[4],d=a[5],e=a[6],f=a[7],g=a[8];return a[0]*(g*c-d*f)+a[1]*(-g*b+d*e)+a[2]*(f*b-c*e)},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],m=b[6],p=b[7];b=b[8];var r=c[0],y=c[1],v=c[2],E=c[3],l=c[4],O=c[5],z=c[6],n=c[7];c=c[8];return a[0]=r*d+y*g+v*
m,a[1]=r*e+y*h+v*p,a[2]=r*f+y*k+v*b,a[3]=E*d+l*g+O*m,a[4]=E*e+l*h+O*p,a[5]=E*f+l*k+O*b,a[6]=z*d+n*g+c*m,a[7]=z*e+n*h+c*p,a[8]=z*f+n*k+c*b,a}};F.mul=F.multiply;F.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],m=b[6],p=b[7];b=b[8];var r=c[0];c=c[1];return a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=k,a[6]=r*d+c*g+m,a[7]=r*e+c*h+p,a[8]=r*f+c*k+b,a};F.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],m=b[6],p=b[7];b=b[8];var r=Math.sin(c);c=Math.cos(c);return a[0]=
c*d+r*g,a[1]=c*e+r*h,a[2]=c*f+r*k,a[3]=c*g-r*d,a[4]=c*h-r*e,a[5]=c*k-r*f,a[6]=m,a[7]=p,a[8]=b,a};F.scale=function(a,b,c){var d=c[0];c=c[1];return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=c*b[3],a[4]=c*b[4],a[5]=c*b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a};F.fromMat2d=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=0,a[3]=b[2],a[4]=b[3],a[5]=0,a[6]=b[4],a[7]=b[5],a[8]=1,a};F.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,k=e+e,m=c*g,p=c*h,c=c*k,r=d*h,d=d*k,e=e*k,g=f*g,h=f*h,f=f*k;return a[0]=
1-(r+e),a[3]=p+f,a[6]=c-h,a[1]=p-f,a[4]=1-(m+e),a[7]=d+g,a[2]=c+h,a[5]=d-g,a[8]=1-(m+r),a};F.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],m=b[7],p=b[8],r=b[9],y=b[10],v=b[11],E=b[12],l=b[13],n=b[14],z=b[15],q=c*h-d*g,w=c*k-e*g,u=c*m-f*g,t=d*k-e*h,s=d*m-f*h,x=e*m-f*k,A=p*l-r*E,B=p*n-y*E,p=p*z-v*E,H=r*n-y*l,r=r*z-v*l,y=y*z-v*n;return(v=q*y-w*r+u*H+t*p-s*B+x*A)?(v=1/v,a[0]=(h*y-k*r+m*H)*v,a[1]=(k*p-g*y-m*B)*v,a[2]=(g*r-h*p+m*A)*v,a[3]=(e*r-d*y-f*H)*v,a[4]=(c*y-e*
p+f*B)*v,a[5]=(d*p-c*r-f*A)*v,a[6]=(l*x-n*s+z*t)*v,a[7]=(n*u-E*x-z*w)*v,a[8]=(E*s-l*u+z*q)*v,a):null};F.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};"undefined"!=typeof l&&(l.mat3=F);var A={create:function(){var a=new s(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},clone:function(a){var b=new s(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=
a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},transpose:function(a,
b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],m=b[7],p=b[8],r=b[9],y=b[10],v=b[11],l=b[12],n=b[13],q=b[14],z=b[15],w=
c*h-d*g,u=c*k-e*g,s=c*m-f*g,t=d*k-e*h,x=d*m-f*h,A=e*m-f*k,B=p*n-r*l,D=p*q-y*l,H=p*z-v*l,F=r*q-y*n,I=r*z-v*n,J=y*z-v*q,C=w*J-u*I+s*F+t*H-x*D+A*B;return C?(C=1/C,a[0]=(h*J-k*I+m*F)*C,a[1]=(e*I-d*J-f*F)*C,a[2]=(n*A-q*x+z*t)*C,a[3]=(y*x-r*A-v*t)*C,a[4]=(k*H-g*J-m*D)*C,a[5]=(c*J-e*H+f*D)*C,a[6]=(q*s-l*A-z*u)*C,a[7]=(p*A-y*s+v*u)*C,a[8]=(g*I-h*H+m*B)*C,a[9]=(d*H-c*I-f*B)*C,a[10]=(l*x-n*s+z*w)*C,a[11]=(r*s-p*x-v*w)*C,a[12]=(h*D-g*F-k*B)*C,a[13]=(c*F-d*D+e*B)*C,a[14]=(n*u-l*t-q*w)*C,a[15]=(p*t-r*u+y*w)*C,
a):null},adjoint:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],m=b[7],p=b[8],r=b[9],y=b[10],v=b[11],l=b[12],n=b[13],q=b[14],z=b[15];return a[0]=h*(y*z-v*q)-r*(k*z-m*q)+n*(k*v-m*y),a[1]=-(d*(y*z-v*q)-r*(e*z-f*q)+n*(e*v-f*y)),a[2]=d*(k*z-m*q)-h*(e*z-f*q)+n*(e*m-f*k),a[3]=-(d*(k*v-m*y)-h*(e*v-f*y)+r*(e*m-f*k)),a[4]=-(g*(y*z-v*q)-p*(k*z-m*q)+l*(k*v-m*y)),a[5]=c*(y*z-v*q)-p*(e*z-f*q)+l*(e*v-f*y),a[6]=-(c*(k*z-m*q)-g*(e*z-f*q)+l*(e*m-f*k)),a[7]=c*(k*v-m*y)-g*(e*v-f*y)+p*(e*m-f*k),a[8]=
g*(r*z-v*n)-p*(h*z-m*n)+l*(h*v-m*r),a[9]=-(c*(r*z-v*n)-p*(d*z-f*n)+l*(d*v-f*r)),a[10]=c*(h*z-m*n)-g*(d*z-f*n)+l*(d*m-f*h),a[11]=-(c*(h*v-m*r)-g*(d*v-f*r)+p*(d*m-f*h)),a[12]=-(g*(r*q-y*n)-p*(h*q-k*n)+l*(h*y-k*r)),a[13]=c*(r*q-y*n)-p*(d*q-e*n)+l*(d*y-e*r),a[14]=-(c*(h*q-k*n)-g*(d*q-e*n)+l*(d*k-e*h)),a[15]=c*(h*y-k*r)-g*(d*y-e*r)+p*(d*k-e*h),a},determinant:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7],m=a[8],p=a[9],r=a[10],l=a[11],v=a[12],n=a[13],q=a[14];a=a[15];return(b*g-
c*f)*(r*a-l*q)-(b*h-d*f)*(p*a-l*n)+(b*k-e*f)*(p*q-r*n)+(c*h-d*g)*(m*a-l*v)-(c*k-e*g)*(m*q-r*v)+(d*k-e*h)*(m*n-p*v)},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],m=b[6],p=b[7],r=b[8],l=b[9],v=b[10],n=b[11],q=b[12],w=b[13],z=b[14];b=b[15];var u=c[0],s=c[1],t=c[2],x=c[3];return a[0]=u*d+s*h+t*r+x*q,a[1]=u*e+s*k+t*l+x*w,a[2]=u*f+s*m+t*v+x*z,a[3]=u*g+s*p+t*n+x*b,u=c[4],s=c[5],t=c[6],x=c[7],a[4]=u*d+s*h+t*r+x*q,a[5]=u*e+s*k+t*l+x*w,a[6]=u*f+s*m+t*v+x*z,a[7]=u*g+s*p+t*n+x*b,u=c[8],
s=c[9],t=c[10],x=c[11],a[8]=u*d+s*h+t*r+x*q,a[9]=u*e+s*k+t*l+x*w,a[10]=u*f+s*m+t*v+x*z,a[11]=u*g+s*p+t*n+x*b,u=c[12],s=c[13],t=c[14],x=c[15],a[12]=u*d+s*h+t*r+x*q,a[13]=u*e+s*k+t*l+x*w,a[14]=u*f+s*m+t*v+x*z,a[15]=u*g+s*p+t*n+x*b,a}};A.mul=A.multiply;A.translate=function(a,b,c){var d=c[0],e=c[1];c=c[2];var f,g,h,k,m,p,r,l,v,n,q,u;return b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(f=b[0],g=b[1],h=b[2],
k=b[3],m=b[4],p=b[5],r=b[6],l=b[7],v=b[8],n=b[9],q=b[10],u=b[11],a[0]=f,a[1]=g,a[2]=h,a[3]=k,a[4]=m,a[5]=p,a[6]=r,a[7]=l,a[8]=v,a[9]=n,a[10]=q,a[11]=u,a[12]=f*d+m*e+v*c+b[12],a[13]=g*d+p*e+n*c+b[13],a[14]=h*d+r*e+q*c+b[14],a[15]=k*d+l*e+u*c+b[15]),a};A.scale=function(a,b,c){var d=c[0],e=c[1];c=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*c,a[9]=b[9]*c,a[10]=b[10]*c,a[11]=b[11]*c,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],
a};A.rotate=function(a,b,c,d){var e=d[0],f=d[1];d=d[2];var g=Math.sqrt(e*e+f*f+d*d),h,k,m,p,r,l,n,q,s,t,w,x,A,D,F,G,K,L,M,H,N,I,J,C;return Math.abs(g)<u?null:(g=1/g,e*=g,f*=g,d*=g,h=Math.sin(c),k=Math.cos(c),m=1-k,p=b[0],r=b[1],l=b[2],n=b[3],q=b[4],s=b[5],t=b[6],w=b[7],x=b[8],A=b[9],D=b[10],F=b[11],G=e*e*m+k,K=f*e*m+d*h,L=d*e*m-f*h,M=e*f*m-d*h,H=f*f*m+k,N=d*f*m+e*h,I=e*d*m+f*h,J=f*d*m-e*h,C=d*d*m+k,a[0]=p*G+q*K+x*L,a[1]=r*G+s*K+A*L,a[2]=l*G+t*K+D*L,a[3]=n*G+w*K+F*L,a[4]=p*M+q*H+x*N,a[5]=r*M+s*H+A*
N,a[6]=l*M+t*H+D*N,a[7]=n*M+w*H+F*N,a[8]=p*I+q*J+x*C,a[9]=r*I+s*J+A*C,a[10]=l*I+t*J+D*C,a[11]=n*I+w*J+F*C,b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a)};A.rotateX=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],g=b[6],h=b[7],k=b[8],m=b[9],p=b[10],r=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=e*c+k*d,a[5]=f*c+m*d,a[6]=g*c+p*d,a[7]=h*c+r*d,a[8]=k*c-e*d,a[9]=m*c-f*d,a[10]=p*c-g*d,a[11]=r*c-h*d,a};A.rotateY=
function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],k=b[8],m=b[9],p=b[10],r=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=e*c-k*d,a[1]=f*c-m*d,a[2]=g*c-p*d,a[3]=h*c-r*d,a[8]=e*d+k*c,a[9]=f*d+m*c,a[10]=g*d+p*c,a[11]=h*d+r*c,a};A.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],k=b[4],m=b[5],p=b[6],r=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=
b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=e*c+k*d,a[1]=f*c+m*d,a[2]=g*c+p*d,a[3]=h*c+r*d,a[4]=k*c-e*d,a[5]=m*c-f*d,a[6]=p*c-g*d,a[7]=r*c-h*d,a};A.fromRotationTranslation=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=d+d,k=e+e,m=f+f;b=d*h;var p=d*k,d=d*m,r=e*k,e=e*m,f=f*m,h=g*h,k=g*k,g=g*m;return a[0]=1-(r+f),a[1]=p+g,a[2]=d-k,a[3]=0,a[4]=p-g,a[5]=1-(b+f),a[6]=e+h,a[7]=0,a[8]=d+k,a[9]=e-h,a[10]=1-(b+r),a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a};A.fromQuat=function(a,b){var c=b[0],
d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,k=e+e,m=c*g,p=c*h,c=c*k,r=d*h,d=d*k,e=e*k,g=f*g,h=f*h,f=f*k;return a[0]=1-(r+e),a[1]=p+f,a[2]=c-h,a[3]=0,a[4]=p-f,a[5]=1-(m+e),a[6]=d+g,a[7]=0,a[8]=c+h,a[9]=d-g,a[10]=1-(m+r),a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a};A.frustum=function(a,b,c,d,e,f,g){var h=1/(c-b),k=1/(e-d),m=1/(f-g);return a[0]=2*f*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*f*k,a[6]=0,a[7]=0,a[8]=(c+b)*h,a[9]=(e+d)*k,a[10]=(g+f)*m,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*(g*f)*m,a[15]=0,a};A.perspective=function(a,
b,c,d,e){b=1/Math.tan(b/2);var f=1/(d-e);return a[0]=b/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*f,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*f,a[15]=0,a};A.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),k=1/(d-e),m=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*k,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*m,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*k,a[14]=(g+f)*m,a[15]=1,a};A.lookAt=function(a,b,c,d){var e,f,g,h,k,m,p,r,l,n,q=b[0],s=b[1];b=b[2];var t=d[0],w=d[1];d=d[2];
var x=c[0],D=c[1];c=c[2];return Math.abs(q-x)<u&&Math.abs(s-D)<u&&Math.abs(b-c)<u?A.identity(a):(p=q-x,r=s-D,l=b-c,n=1/Math.sqrt(p*p+r*r+l*l),p*=n,r*=n,l*=n,e=w*l-d*r,f=d*p-t*l,g=t*r-w*p,n=Math.sqrt(e*e+f*f+g*g),n?(n=1/n,e*=n,f*=n,g*=n):(e=0,f=0,g=0),h=r*g-l*f,k=l*e-p*g,m=p*f-r*e,n=Math.sqrt(h*h+k*k+m*m),n?(n=1/n,h*=n,k*=n,m*=n):(h=0,k=0,m=0),a[0]=e,a[1]=h,a[2]=p,a[3]=0,a[4]=f,a[5]=k,a[6]=r,a[7]=0,a[8]=g,a[9]=m,a[10]=l,a[11]=0,a[12]=-(e*q+f*s+g*b),a[13]=-(h*q+k*s+m*b),a[14]=-(p*q+r*s+l*b),a[15]=1,
a)};A.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};"undefined"!=typeof l&&(l.mat4=A);var t={create:function(){var a=new s(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}};t.rotationTo=function(){var a=q.create(),b=q.fromValues(1,0,0),c=q.fromValues(0,1,0);return function(d,e,f){var g=q.dot(e,f);return-0.999999>g?(q.cross(a,b,e),1E-6>q.length(a)&&q.cross(a,
c,e),q.normalize(a,a),t.setAxisAngle(d,a,Math.PI),d):0.999999<g?(d[0]=0,d[1]=0,d[2]=0,d[3]=1,d):(q.cross(a,e,f),d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=1+g,t.normalize(d,d))}}();t.setAxes=function(){var a=F.create();return function(b,c,d,e){return a[0]=d[0],a[3]=d[1],a[6]=d[2],a[1]=e[0],a[4]=e[1],a[7]=e[2],a[2]=c[0],a[5]=c[1],a[8]=c[2],t.normalize(b,t.fromMat3(b,a))}}();t.clone=n.clone;t.fromValues=n.fromValues;t.copy=n.copy;t.set=n.set;t.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a};t.setAxisAngle=
function(a,b,c){c*=0.5;var d=Math.sin(c);return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=Math.cos(c),a};t.add=n.add;t.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],k=c[2];c=c[3];return a[0]=d*c+b*g+e*k-f*h,a[1]=e*c+b*h+f*g-d*k,a[2]=f*c+b*k+d*h-e*g,a[3]=b*c-d*g-e*h-f*k,a};t.mul=t.multiply;t.scale=n.scale;t.rotateX=function(a,b,c){c*=0.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);return a[0]=d*c+b*g,a[1]=e*c+f*g,a[2]=f*c-e*g,a[3]=b*c-d*g,a};t.rotateY=
function(a,b,c){c*=0.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);return a[0]=d*c-f*g,a[1]=e*c+b*g,a[2]=f*c+d*g,a[3]=b*c-e*g,a};t.rotateZ=function(a,b,c){c*=0.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);return a[0]=d*c+e*g,a[1]=e*c-d*g,a[2]=f*c+b*g,a[3]=b*c-f*g,a};t.calculateW=function(a,b){var c=b[0],d=b[1],e=b[2];return a[0]=c,a[1]=d,a[2]=e,a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a};t.dot=n.dot;t.lerp=n.lerp;t.slerp=function(a,b,c,d){var e=b[0],f=b[1],
g=b[2];b=b[3];var h=c[0],k=c[1],m=c[2];c=c[3];var n,l,q,s,t;return l=e*h+f*k+g*m+b*c,0>l&&(l=-l,h=-h,k=-k,m=-m,c=-c),1E-6<1-l?(n=Math.acos(l),q=Math.sin(n),s=Math.sin((1-d)*n)/q,t=Math.sin(d*n)/q):(s=1-d,t=d),a[0]=s*e+t*h,a[1]=s*f+t*k,a[2]=s*g+t*m,a[3]=s*b+t*c,a};t.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f,g=g?1/g:0;return a[0]=-c*g,a[1]=-d*g,a[2]=-e*g,a[3]=f*g,a};t.conjugate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=b[3],a};t.length=n.length;t.len=t.length;
t.squaredLength=n.squaredLength;t.sqrLen=t.squaredLength;t.normalize=n.normalize;t.fromMat3=function(){var a="undefined"!=typeof Int8Array?new Int8Array([1,2,0]):[1,2,0];return function(b,c){var d=c[0]+c[4]+c[8];if(0<d)d=Math.sqrt(d+1),b[3]=0.5*d,d=0.5/d,b[0]=(c[7]-c[5])*d,b[1]=(c[2]-c[6])*d,b[2]=(c[3]-c[1])*d;else{var e=0;c[4]>c[0]&&(e=1);c[8]>c[3*e+e]&&(e=2);var f=a[e],g=a[f],d=Math.sqrt(c[3*e+e]-c[3*f+f]-c[3*g+g]+1);b[e]=0.5*d;d=0.5/d;b[3]=(c[3*g+f]-c[3*f+g])*d;b[f]=(c[3*f+e]+c[3*e+f])*d;b[g]=
(c[3*g+e]+c[3*e+g])*d}return b}}();t.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!=typeof l&&(l.quat=t)})(u)})(this);Rubikjs.Render.Buffer=function(l){l&&(this.data=l)};Rubikjs.Render.Buffer.prototype.feed=function(l){this.data=l};Rubikjs.Render.Buffer.prototype.copy=function(){return new Rubikjs.Render.Buffer(this.data)};
Rubikjs.Render.Renderer=function(l){l&&(this.perspectiveMat=mat4.create(),mat4.perspective(this.perspectiveMat,70,l.offsetWidth/l.offsetHeight,0.1,100),this.element=l)};Rubikjs.Render.Renderer.prototype.startFrame=function(){};Rubikjs.Render.Renderer.prototype.render=function(l){};Rubikjs.Render.Renderer.prototype.endFrame=function(){};Rubikjs.Render.Renderer.prototype.createMesh=function(){return new Rubikjs.Mesh};
Rubikjs.Render.Mesh=function(){this.transform=mat4.create();this.vertexBuffer=new Rubikjs.Render.Buffer;this.colorBuffer=new Rubikjs.Render.Buffer;this.indexBuffer=new Rubikjs.Render.Buffer};Rubikjs.Render.Mesh.prototype.copy=function(){var l=new Rubikjs.Render.Mesh;l.transform=mat4.clone(this.transform);l.vertexBuffer=this.vertexBuffer.copy();l.colorBuffer=this.colorBuffer.copy();l.indexBuffer=this.indexBuffer.copy();return l};
Rubikjs.Render.RenderManager=function(l){this.meshs=[];this.renderer=l?new l(document.getElementById("cube")):new Rubikjs.WebGL.Renderer(document.getElementById("cube"))};Rubikjs.Render.RenderManager.prototype.render=function(){this.renderer.startFrame();var l=this;this.meshs.forEach(function(u){l.renderer.render(u)});this.renderer.endFrame()};Rubikjs.Render.RenderManager.prototype.transformCamera=function(l){mat4.multiply(this.renderer.perspectiveMat,this.renderer.perspectiveMat,l)};
Rubikjs.Render.PieceFactory=function(l,u,G,B){this.pieceConstructor=l;this.baseMesh=u;this.namedColorBuffer=G;this.defaultColors=B};
Rubikjs.Render.PieceFactory.prototype.create=function(l,u,G){var B=Rubikjs.Core.Utils.makeOptions(this.defaultColors,G);G=this.namedColorBuffer.map(function(l){return B[l]}).reduce(function(l,s){return l.concat(s)},[]);var s=this.baseMesh.copy();s.colorBuffer.feed(G);mat4.translate(s.transform,s.transform,l);mat4.rotateX(s.transform,s.transform,u[0]);mat4.rotateY(s.transform,s.transform,u[1]);mat4.rotateZ(s.transform,s.transform,u[2]);return new this.pieceConstructor(s)};
Rubikjs.Render.StickerHelper=function(l){this.generator=l};
Rubikjs.Render.StickerHelper.prototype.create=function(l,u,G,B){B=B||!1;u=this.generator(u,G);if(u.index){if(B)for(B=0;B<u.index.length;B+=3)G=u.index[B+1],u.index[B+1]=u.index[B+2],u.index[B+2]=G;l.indexBuffer.feed(l.indexBuffer.data.concat(u.index.map(function(s){return s+l.vertexBuffer.data.length/3})))}u.vertex&&l.vertexBuffer.feed(l.vertexBuffer.data.concat(u.vertex));u.color&&l.colorBuffer.feed(l.colorBuffer.data.concat(u.color));if(u.other)for(var s in u.other)l[s]=l[s].concat(u.other[s])};
