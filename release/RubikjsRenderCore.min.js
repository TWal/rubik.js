//License: https://github.com/TWal/rubik.js/blob/master/LICENSE and https://github.com/toji/gl-matrix/blob/master/LICENSE.md (glmatrix)

(function(a){a.glMatrixArrayType=a.MatrixArray=null;a.vec3={};a.mat3={};a.mat4={};a.quat4={};a.setMatrixArrayType=function(a){return glMatrixArrayType=MatrixArray=a};a.determineMatrixArrayType=function(){return setMatrixArrayType("undefined"!==typeof Float32Array?Float32Array:Array)};determineMatrixArrayType()})("undefined"!=typeof exports?global:this);vec3.create=function(a){var b=new MatrixArray(3);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2]):b[0]=b[1]=b[2]=0;return b};
vec3.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};vec3.add=function(a,b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};vec3.subtract=function(a,b,c){if(!c||a===c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};vec3.multiply=function(a,b,c){if(!c||a===c)return a[0]*=b[0],a[1]*=b[1],a[2]*=b[2],a;c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];return c};
vec3.negate=function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};vec3.scale=function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};vec3.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=Math.sqrt(c*c+d*d+e*e);if(g){if(1===g)return b[0]=c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;g=1/g;b[0]=c*g;b[1]=d*g;b[2]=e*g;return b};
vec3.cross=function(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var g=b[0],f=b[1];b=b[2];c[0]=e*b-a*f;c[1]=a*g-d*b;c[2]=d*f-e*g;return c};vec3.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};vec3.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};vec3.direction=function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(d*d+e*e+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c};
vec3.lerp=function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d};vec3.dist=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)};
vec3.unproject=function(a,b,c,d,e){e||(e=a);var g=mat4.create(),f=new MatrixArray(4);f[0]=2*(a[0]-d[0])/d[2]-1;f[1]=2*(a[1]-d[1])/d[3]-1;f[2]=2*a[2]-1;f[3]=1;mat4.multiply(c,b,g);if(!mat4.inverse(g))return null;mat4.multiplyVec4(g,f);if(0===f[3])return null;e[0]=f[0]/f[3];e[1]=f[1]/f[3];e[2]=f[2]/f[3];return e};vec3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};
mat3.create=function(a){var b=new MatrixArray(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]);return b};mat3.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};mat3.identity=function(a){a||(a=mat3.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};
mat3.transpose=function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b};mat3.toMat4=function(a,b){b||(b=mat4.create());b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};
mat3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};mat4.create=function(a){var b=new MatrixArray(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b};
mat4.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};mat4.identity=function(a){a||(a=mat4.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
mat4.transpose=function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[3],g=a[6],f=a[7],h=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=g;a[11]=a[14];a[12]=e;a[13]=f;a[14]=h;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b};
mat4.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],f=a[5],h=a[6],k=a[7],l=a[8],m=a[9],n=a[10],q=a[11],r=a[12],p=a[13],s=a[14];a=a[15];return r*m*h*e-l*p*h*e-r*f*n*e+g*p*n*e+l*f*s*e-g*m*s*e-r*m*d*k+l*p*d*k+r*c*n*k-b*p*n*k-l*c*s*k+b*m*s*k+r*f*d*q-g*p*d*q-r*c*h*q+b*p*h*q+g*c*s*q-b*f*s*q-l*f*d*a+g*m*d*a+l*c*h*a-b*m*h*a-g*c*n*a+b*f*n*a};
mat4.inverse=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],f=a[4],h=a[5],k=a[6],l=a[7],m=a[8],n=a[9],q=a[10],r=a[11],p=a[12],s=a[13],u=a[14],v=a[15],D=c*h-d*f,E=c*k-e*f,w=c*l-g*f,x=d*k-e*h,y=d*l-g*h,z=e*l-g*k,A=m*s-n*p,B=m*u-q*p,C=m*v-r*p,F=n*u-q*s,G=n*v-r*s,H=q*v-r*u,t=D*H-E*G+w*F+x*C-y*B+z*A;if(!t)return null;t=1/t;b[0]=(h*H-k*G+l*F)*t;b[1]=(-d*H+e*G-g*F)*t;b[2]=(s*z-u*y+v*x)*t;b[3]=(-n*z+q*y-r*x)*t;b[4]=(-f*H+k*C-l*B)*t;b[5]=(c*H-e*C+g*B)*t;b[6]=(-p*z+u*w-v*E)*t;b[7]=(m*z-q*w+r*E)*t;b[8]=
(f*G-h*C+l*A)*t;b[9]=(-c*G+d*C-g*A)*t;b[10]=(p*y-s*w+v*D)*t;b[11]=(-m*y+n*w-r*D)*t;b[12]=(-f*F+h*B-k*A)*t;b[13]=(c*F-d*B+e*A)*t;b[14]=(-p*x+s*E-u*D)*t;b[15]=(m*x-n*E+q*D)*t;return b};mat4.toRotationMat=function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
mat4.toMat3=function(a,b){b||(b=mat3.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};mat4.toInverseMat3=function(a,b){var c=a[0],d=a[1],e=a[2],g=a[4],f=a[5],h=a[6],k=a[8],l=a[9],m=a[10],n=m*f-h*l,q=-m*g+h*k,r=l*g-f*k,p=c*n+d*q+e*r;if(!p)return null;p=1/p;b||(b=mat3.create());b[0]=n*p;b[1]=(-m*d+e*l)*p;b[2]=(h*d-e*f)*p;b[3]=q*p;b[4]=(m*c-e*k)*p;b[5]=(-h*c+e*g)*p;b[6]=r*p;b[7]=(-l*c+d*k)*p;b[8]=(f*c-d*g)*p;return b};
mat4.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2],f=a[3],h=a[4],k=a[5],l=a[6],m=a[7],n=a[8],q=a[9],r=a[10],p=a[11],s=a[12],u=a[13],v=a[14];a=a[15];var D=b[0],E=b[1],w=b[2],x=b[3],y=b[4],z=b[5],A=b[6],B=b[7],C=b[8],F=b[9],G=b[10],H=b[11],t=b[12],I=b[13],J=b[14];b=b[15];c[0]=D*d+E*h+w*n+x*s;c[1]=D*e+E*k+w*q+x*u;c[2]=D*g+E*l+w*r+x*v;c[3]=D*f+E*m+w*p+x*a;c[4]=y*d+z*h+A*n+B*s;c[5]=y*e+z*k+A*q+B*u;c[6]=y*g+z*l+A*r+B*v;c[7]=y*f+z*m+A*p+B*a;c[8]=C*d+F*h+G*n+H*s;c[9]=C*e+F*k+G*q+H*u;c[10]=C*
g+F*l+G*r+H*v;c[11]=C*f+F*m+G*p+H*a;c[12]=t*d+I*h+J*n+b*s;c[13]=t*e+I*k+J*q+b*u;c[14]=t*g+I*l+J*r+b*v;c[15]=t*f+I*m+J*p+b*a;return c};mat4.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c};
mat4.multiplyVec4=function(a,b,c){c||(c=b);var d=b[0],e=b[1],g=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*g+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*g+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*g+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*g+a[15]*b;return c};
mat4.translate=function(a,b,c){var d=b[0],e=b[1];b=b[2];var g,f,h,k,l,m,n,q,r,p,s,u;if(!c||a===c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;g=a[0];f=a[1];h=a[2];k=a[3];l=a[4];m=a[5];n=a[6];q=a[7];r=a[8];p=a[9];s=a[10];u=a[11];c[0]=g;c[1]=f;c[2]=h;c[3]=k;c[4]=l;c[5]=m;c[6]=n;c[7]=q;c[8]=r;c[9]=p;c[10]=s;c[11]=u;c[12]=g*d+l*e+r*b+a[12];c[13]=f*d+m*e+p*b+a[13];c[14]=h*d+n*e+s*b+a[14];c[15]=k*d+q*e+u*b+
a[15];return c};mat4.scale=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a===c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};
mat4.rotate=function(a,b,c,d){var e=c[0],g=c[1];c=c[2];var f=Math.sqrt(e*e+g*g+c*c),h,k,l,m,n,q,r,p,s,u,v,D,E,w,x,y,z,A,B,C;if(!f)return null;1!==f&&(f=1/f,e*=f,g*=f,c*=f);h=Math.sin(b);k=Math.cos(b);l=1-k;b=a[0];f=a[1];m=a[2];n=a[3];q=a[4];r=a[5];p=a[6];s=a[7];u=a[8];v=a[9];D=a[10];E=a[11];w=e*e*l+k;x=g*e*l+c*h;y=c*e*l-g*h;z=e*g*l-c*h;A=g*g*l+k;B=c*g*l+e*h;C=e*c*l+g*h;e=g*c*l-e*h;g=c*c*l+k;d?a!==d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*w+q*x+u*y;d[1]=f*w+r*x+v*y;d[2]=m*w+p*
x+D*y;d[3]=n*w+s*x+E*y;d[4]=b*z+q*A+u*B;d[5]=f*z+r*A+v*B;d[6]=m*z+p*A+D*B;d[7]=n*z+s*A+E*B;d[8]=b*C+q*e+u*g;d[9]=f*C+r*e+v*g;d[10]=m*C+p*e+D*g;d[11]=n*C+s*e+E*g;return d};
mat4.rotateX=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[4],g=a[5],f=a[6],h=a[7],k=a[8],l=a[9],m=a[10],n=a[11];c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=e*b+k*d;c[5]=g*b+l*d;c[6]=f*b+m*d;c[7]=h*b+n*d;c[8]=e*-d+k*b;c[9]=g*-d+l*b;c[10]=f*-d+m*b;c[11]=h*-d+n*b;return c};
mat4.rotateY=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],f=a[2],h=a[3],k=a[8],l=a[9],m=a[10],n=a[11];c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+k*-d;c[1]=g*b+l*-d;c[2]=f*b+m*-d;c[3]=h*b+n*-d;c[8]=e*d+k*b;c[9]=g*d+l*b;c[10]=f*d+m*b;c[11]=h*d+n*b;return c};
mat4.rotateZ=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],f=a[2],h=a[3],k=a[4],l=a[5],m=a[6],n=a[7];c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+k*d;c[1]=g*b+l*d;c[2]=f*b+m*d;c[3]=h*b+n*d;c[4]=e*-d+k*b;c[5]=g*-d+l*b;c[6]=f*-d+m*b;c[7]=h*-d+n*b;return c};
mat4.frustum=function(a,b,c,d,e,g,f){f||(f=mat4.create());var h=b-a,k=d-c,l=g-e;f[0]=2*e/h;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2*e/k;f[6]=0;f[7]=0;f[8]=(b+a)/h;f[9]=(d+c)/k;f[10]=-(g+e)/l;f[11]=-1;f[12]=0;f[13]=0;f[14]=-(2*g*e)/l;f[15]=0;return f};mat4.perspective=function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return mat4.frustum(-b,b,-a,a,c,d,e)};
mat4.ortho=function(a,b,c,d,e,g,f){f||(f=mat4.create());var h=b-a,k=d-c,l=g-e;f[0]=2/h;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2/k;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=-2/l;f[11]=0;f[12]=-(a+b)/h;f[13]=-(d+c)/k;f[14]=-(g+e)/l;f[15]=1;return f};
mat4.lookAt=function(a,b,c,d){d||(d=mat4.create());var e,g,f,h,k,l,m,n,q=a[0],r=a[1];a=a[2];f=c[0];h=c[1];g=c[2];m=b[0];c=b[1];e=b[2];if(q===m&&r===c&&a===e)return mat4.identity(d);b=q-m;c=r-c;m=a-e;n=1/Math.sqrt(b*b+c*c+m*m);b*=n;c*=n;m*=n;e=h*m-g*c;g=g*b-f*m;f=f*c-h*b;(n=Math.sqrt(e*e+g*g+f*f))?(n=1/n,e*=n,g*=n,f*=n):f=g=e=0;h=c*f-m*g;k=m*e-b*f;l=b*g-c*e;(n=Math.sqrt(h*h+k*k+l*l))?(n=1/n,h*=n,k*=n,l*=n):l=k=h=0;d[0]=e;d[1]=h;d[2]=b;d[3]=0;d[4]=g;d[5]=k;d[6]=c;d[7]=0;d[8]=f;d[9]=l;d[10]=m;d[11]=
0;d[12]=-(e*q+g*r+f*a);d[13]=-(h*q+k*r+l*a);d[14]=-(b*q+c*r+m*a);d[15]=1;return d};mat4.fromRotationTranslation=function(a,b,c){c||(c=mat4.create());var d=a[0],e=a[1],g=a[2],f=a[3],h=d+d,k=e+e,l=g+g;a=d*h;var m=d*k,d=d*l,n=e*k,e=e*l,g=g*l,h=f*h,k=f*k,f=f*l;c[0]=1-(n+g);c[1]=m+f;c[2]=d-k;c[3]=0;c[4]=m-f;c[5]=1-(a+g);c[6]=e+h;c[7]=0;c[8]=d+k;c[9]=e-h;c[10]=1-(a+n);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c};
mat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};quat4.create=function(a){var b=new MatrixArray(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};quat4.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};
quat4.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a===b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a;b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};quat4.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};quat4.inverse=function(a,b){var c=a[0],d=a[1],e=a[2],g=a[3],c=(c=c*c+d*d+e*e+g*g)?1/c:0;if(!b||a===b)return a[0]*=-c,a[1]*=-c,a[2]*=-c,a[3]*=c,a;b[0]=-a[0]*c;b[1]=-a[1]*c;b[2]=-a[2]*c;b[3]=a[3]*c;return b};
quat4.conjugate=function(a,b){if(!b||a===b)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};quat4.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};quat4.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],f=Math.sqrt(c*c+d*d+e*e+g*g);if(0===f)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;b[3]=g*f;return b};
quat4.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2];a=a[3];var f=b[0],h=b[1],k=b[2];b=b[3];c[0]=d*b+a*f+e*k-g*h;c[1]=e*b+a*h+g*f-d*k;c[2]=g*b+a*k+d*h-e*f;c[3]=a*b-d*f-e*h-g*k;return c};quat4.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1],g=b[2];b=a[0];var f=a[1],h=a[2];a=a[3];var k=a*d+f*g-h*e,l=a*e+h*d-b*g,m=a*g+b*e-f*d,d=-b*d-f*e-h*g;c[0]=k*a+d*-b+l*-h-m*-f;c[1]=l*a+d*-f+m*-b-k*-h;c[2]=m*a+d*-h+k*-f-l*-b;return c};
quat4.toMat3=function(a,b){b||(b=mat3.create());var c=a[0],d=a[1],e=a[2],g=a[3],f=c+c,h=d+d,k=e+e,l=c*f,m=c*h,c=c*k,n=d*h,d=d*k,e=e*k,f=g*f,h=g*h,g=g*k;b[0]=1-(n+e);b[1]=m+g;b[2]=c-h;b[3]=m-g;b[4]=1-(l+e);b[5]=d+f;b[6]=c+h;b[7]=d-f;b[8]=1-(l+n);return b};
quat4.toMat4=function(a,b){b||(b=mat4.create());var c=a[0],d=a[1],e=a[2],g=a[3],f=c+c,h=d+d,k=e+e,l=c*f,m=c*h,c=c*k,n=d*h,d=d*k,e=e*k,f=g*f,h=g*h,g=g*k;b[0]=1-(n+e);b[1]=m+g;b[2]=c-h;b[3]=0;b[4]=m-g;b[5]=1-(l+e);b[6]=d+f;b[7]=0;b[8]=c+h;b[9]=d-f;b[10]=1-(l+n);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
quat4.slerp=function(a,b,c,d){d||(d=a);var e=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3],g,f;if(1<=Math.abs(e))return d!==a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3]),d;g=Math.acos(e);f=Math.sqrt(1-e*e);if(0.0010>Math.abs(f))return d[0]=0.5*a[0]+0.5*b[0],d[1]=0.5*a[1]+0.5*b[1],d[2]=0.5*a[2]+0.5*b[2],d[3]=0.5*a[3]+0.5*b[3],d;e=Math.sin((1-c)*g)/f;c=Math.sin(c*g)/f;d[0]=a[0]*e+b[0]*c;d[1]=a[1]*e+b[1]*c;d[2]=a[2]*e+b[2]*c;d[3]=a[3]*e+b[3]*c;return d};
quat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};(function(a){a.Rubikjs={};a.Rubikjs.Render={};a.Rubikjs.Render.SVG={};a.Rubikjs.Render.Canvas={};a.Rubikjs.Render.WebGL={};a.Rubikjs.Twisty={};a.Rubikjs.Notation={};a.Rubikjs.Puzzle={}})("undefined"!=typeof exports?global:this);Rubikjs.Render.Buffer=function(a){a&&(this.data=a)};Rubikjs.Render.Buffer.prototype.feed=function(a){this.data=a};
Rubikjs.Render.Renderer=function(a){a&&(this.perspectiveMat=mat4.create(),mat4.perspective(70,a.offsetWidth/a.offsetHeight,0.1,100,this.perspectiveMat),this.element=a)};Rubikjs.Render.Renderer.prototype.startFrame=function(){};Rubikjs.Render.Renderer.prototype.render=function(a){};Rubikjs.Render.Renderer.prototype.endFrame=function(){};Rubikjs.Render.Renderer.prototype.createMesh=function(){return new Rubikjs.Mesh};
Rubikjs.Render.Mesh=function(){this.beautifulLevel=1;this.transform=mat4.create();mat4.identity(this.transform);this.vertexBuffer=new Rubikjs.Render.Buffer;this.colorBuffer=new Rubikjs.Render.Buffer;this.indexBuffer=new Rubikjs.Render.Buffer};
Rubikjs.Render.RenderManager=function(a){this.meshs=[];this.renderer=a?new a(document.getElementById("cube")):new Rubikjs.WebGL.Renderer(document.getElementById("cube"));mat4.translate(this.renderer.perspectiveMat,[0,0,-15]);mat4.rotateX(this.renderer.perspectiveMat,Math.PI/6);mat4.rotateY(this.renderer.perspectiveMat,-Math.PI/6)};Rubikjs.Render.RenderManager.prototype.render=function(){this.renderer.startFrame();var a=this;this.meshs.forEach(function(b){a.renderer.render(b)});this.renderer.endFrame()};
